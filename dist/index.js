import React from"react";import{useQuery,QueryClient,QueryClientProvider}from"react-query";import axios from"axios";import{PoRT}from"@_koi/port";function __rest(e,n){var t={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]]);return t}function __awaiter(e,i,s,l){return new(s=s||Promise)(function(t,n){function r(e){try{a(l.next(e))}catch(e){n(e)}}function o(e){try{a(l.throw(e))}catch(e){n(e)}}function a(e){var n;e.done?t(e.value):((n=e.value)instanceof s?n:new s(function(e){e(n)})).then(r,o)}a((l=l.apply(e,i||[])).next())})}function styleInject(e,n){var t,r,n=(n=void 0===n?{}:n).insertAt;e&&"undefined"!=typeof document&&(t=document.head||document.getElementsByTagName("head")[0],(r=document.createElement("style")).type="text/css","top"===n&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)))}var css_248z$1=".storybook-button {\n  font-family: 'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  font-weight: 700;\n  border: 0;\n  border-radius: 3em;\n  cursor: pointer;\n  display: inline-block;\n  line-height: 1;\n}\n.storybook-button--primary {\n  color: white;\n  background-color: #1ea7fd;\n}\n.storybook-button--secondary {\n  color: #333;\n  background-color: transparent;\n  box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px inset;\n}\n.storybook-button--small {\n  font-size: 12px;\n  padding: 10px 16px;\n}\n.storybook-button--medium {\n  font-size: 14px;\n  padding: 11px 20px;\n}\n.storybook-button--large {\n  font-size: 16px;\n  padding: 12px 24px;\n}\n";styleInject(css_248z$1);const Button=e=>{var{primary:n=!1,size:t="medium",backgroundColor:r,label:o}=e,e=__rest(e,["primary","size","backgroundColor","label"]);const a=n?"storybook-button--primary":"storybook-button--secondary";return React.createElement("button",Object.assign({type:"button",className:["storybook-button","storybook-button--"+t,a].join(" "),style:{backgroundColor:r}},e),o)},REACT_APP_BUNDLER_API_URL="https://mainnet.koii.live",customAxios=axios.create({baseURL:REACT_APP_BUNDLER_API_URL}),fetchNft=(customAxios.defaults.headers.common["Content-Type"]="application/json",customAxios.defaults.headers.post["Content-Type"]="application/json",n=>__awaiter(void 0,void 0,void 0,function*(){try{if(!n)return;var e=(yield customAxios.get("/attention/nft?id="+n))["data"];return e}catch(e){return}}));function useNft({id:e}){return useQuery("nft-"+e,()=>fetchNft(e),{staleTime:36e5,refetchOnWindowFocus:void 0})}const REACT_APP_NODE_URL="https://mainnet.koii.live";let port=new PoRT({trustedNodeAddress:REACT_APP_NODE_URL,node:5});const getMediaType=e=>{let n=e;return e&&(e.includes("image/")?n="image":e.includes("video/")?n="video":e.includes("text/html")&&(n="iframe")),n},triggerPort=e=>{port.propagatePoRT(e)},NftMediaContainer=({nft:e})=>{const n=getMediaType(null==e?void 0:e.contentType),t="https://arweave.net/"+(null==e?void 0:e.id),r=()=>React.createElement("iframe",{className:"monalisa_slide",src:t,onLoad:()=>triggerPort(null==e?void 0:e.id)}),o=()=>React.createElement("img",{className:"monalisa_slide",src:t,alt:"blinds_by_vinciis",onLoad:()=>triggerPort(null==e?void 0:e.id)}),a=()=>React.createElement("video",{className:"monalisa_slide",controls:!0,muted:!0,onLoadedData:()=>triggerPort(null==e?void 0:e.id)},React.createElement("source",{src:t}));return React.createElement(React.Fragment,null,(()=>{switch(n){case"image":return React.createElement(o,null);case"video":return React.createElement(a,null);case"iframe":return React.createElement(r,null);default:return React.createElement(React.Fragment,null)}})())},MonaApp=({screen:e,monaName:n})=>{const t=e,[r,o]=React.useState(0),a=React.useRef(null),[i,d]=React.useState([]),[s,m]=React.useState(""),{data:l,isLoading:u,isError:c}=useNft({id:s});return React.useEffect(()=>{__awaiter(void 0,void 0,void 0,function*(){try{const e=yield window.fetch(`https://vblinds.herokuapp.com/api/screens/${t}/screenVideos`),n=yield e.json();d(n),console.log(n),n.map(e=>e.thumbnail).map(e=>e.split("https://arweave.net/")[1]).map(e=>m(e)),a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{o(e=>e===(i.length-1||i.length)?0:e+1)},2e3)}catch(e){console.error(e)}})},[r,i.length,t]),React.createElement("div",{className:n},React.createElement("div",{className:"monalisa_slideshowSlider ",style:{transform:`translate3d(${100*-r}%, 0, 0)`}},u&&React.createElement(React.Fragment,null,"Loading"),c&&React.createElement(React.Fragment,null,c),l&&i.map(e=>React.createElement("a",{key:e._id,"aria-label":"Blinds by Vinciis",href:"https://vblinds.herokuapp.com/video/"+e._id,target:"_blank",rel:"noopener noreferrer"},React.createElement(NftMediaContainer,{key:s,nft:l})))))};var css_248z="\r\n.monalisa_slideshowSlider {\r\n  white-space: nowrap;\r\n  position: relative;\r\n  transition: ease 1000ms;\r\n  height: 100%;\r\n}\r\n\r\n.monalisa_slide {\r\n  display: inline-block flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 100%;\r\n  max-height: 10%;\r\n  border-radius: 5px;\r\n  transition: .5s ease;\r\n}\r\n\r\n.monalisa_slide:hover {\r\n  opacity: 0.8;\r\n}\r\n\r\n.monalisa_slideshow_1 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 10rem;\r\n}\r\n\r\n.monalisa_slideshow_100 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 10rem;\r\n}\r\n\r\n.monalisa_slideshow_240 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 240rem;\r\n}\r\n\r\n.monalisa_slideshow_480 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 48rem;\r\n}\r\n\r\n.monalisa_slideshow_540 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 54rem;\r\n}\r\n\r\n.monalisa_slideshow_720 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 72rem;\r\n}\r\n\r\n.monalisa_slideshow_1080 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 108rem;\r\n}\r\n\r\n.monalisa_slideshow_2160 {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 216rem;\r\n}\r\n\r\n.monalisa_slideshow_full {\r\n  margin: 0 auto;\r\n  overflow: hidden;\r\n  max-width: 100%;\r\n  height: 100%;\r\n}\r\n";styleInject(css_248z);const queryClient=new QueryClient,Monalisa=({screen:e="61e1532b4cdb8cfa375286da",monaName:n="monalisa_slideshow_2160"})=>React.createElement(React.Fragment,null,React.createElement(QueryClientProvider,{client:queryClient},React.createElement("div",null,React.createElement(MonaApp,{monaName:n,screen:e}))));export{Button,Monalisa};
